<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Auto refresh every 10 seconds -->
        <meta http-equiv="refresh" content="10" >

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        
        <!-- Iconic -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic-bootstrap.css" rel="stylesheet">
        
        <!-- CSS -->
        <link href="{{ url_for('static', filename='index.css')}}" rel="stylesheet">

        <title>People Vs. Noise</title>
    </head>
    <body>
        <h1 class="text-center text-white bg-dark">People Vs Noise Application</h1>

        <h2><span class="oi oi-people"></span> {{people.number}} people in the room</h2>
        
        {% set last_entry = decibels|last %}
        <h2 class="inline">Noise Level: {{ last_entry.db }} dB / </h2>
        {% if last_entry.db <= 40 %}
        <h2 class="text-success inline">Quiet</h2>
        <h2 class="inline"><span class="oi oi-volume-off"></span></h2>
        {% elif last_entry.db <= 60 %}
        <h2 class="text-warning inline">Moderate</h2>
        <h2 class="inline"><span class="oi oi-volume-low"></span></h2>
        {% else %}
        <h2 class="text-danger inline">Loud</h2>
        <h2 class="inline"><span class="oi oi-volume-high"></span></h2>
        {% endif %}
        
        <!-- {% for db in decibels %}
        <div><p>{{ db.ts }}: <b>{{ db.db }} decibels</b></p></div>
        {% endfor %} -->

        <!-- <h2><span class="oi oi-volume-high"></span>Noise history :</h2> -->
        <!-- <div class="progress">
                <div class="progress-bar" role="progressbar" style="width: 15%" aria-valuenow="15" aria-valuemin="0" aria-valuemax="100"></div>
                <div class="progress-bar bg-success" role="progressbar" style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"></div>
                <div class="progress-bar bg-info" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100"></div>
        </div> -->

        <canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>

        <!-- Optional JavaScript -->
        <!-- jQuery first, then Popper.js, then Bootstrap JS -->
        <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script> -->
        <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script> -->
    
        <script>let decibels = {{ decibels|tojson }}</script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.9.0/feather.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
        <script type="text/javascript" src="{{ url_for('static', filename='chart.js') }}"></script>
    </body>
</html>